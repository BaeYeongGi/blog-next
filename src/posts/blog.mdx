---
title: "ê°œì¸ ë¸”ë¡œê·¸ ë§Œë“¤ê¸° Next.js 14"
date: "2024-08-27"
summary: "Next.js ì™€ MDX ë§ˆí¬ë‹¤ìš´ íŒŒì¼ë¡œ ê°œì¸ ë¸”ë¡œê·¸ë¥¼ ì˜ˆì˜ê²Œ ë§Œë“¤ì–´ ë´…ì‹œë‹¤ğŸ˜Š"
thumbnail: "/images/posts/blog/thumbnail.png"
---

![](/images/posts/blog/thumbnail.png)

## ê°œìš”

í¼ë¸”ë¦¬ì…”ë¡œ ì—´ì‹¬íˆ ì¼í•˜ë˜ ì‹œì ˆ [ë„¤ì´ë²„ ë¸”ë¡œê·¸](https://blog.naver.com/byk5913)ì— í•™ìŠµë‚´ìš©ì„ ê¸°ë¡í•˜ë©´ì„œ í¸í•˜ê²Œ ì´ìš©í–ˆì§€ë§Œ, ë§ˆí¬ë‹¤ìš´ ë¬¸ë²•ë„ ìµí˜€ë³´ê³  ìƒˆë¡œìš´ ë§ˆìŒìœ¼ë¡œ ì§ì ‘ ë©‹ìˆê²Œ ê°œë°œí•œ ë¸”ë¡œê·¸ì— ì½”ë“œë¥¼ ê¸°ë¡í•˜ê±°ë‚˜ ì œê°€ ì‘ì—…í–ˆë˜ ë‚´ìš©ì„ í†ºì•„ë³´ê¸° ìœ„í•´ ì œì‘í•˜ë©´ ì¢‹ê² ë‹¤ëŠ” ìƒê°ì„ í–ˆìŠµë‹ˆë‹¤! í•„ìš”í•œ ê¸°ëŠ¥ìœ¼ë¡œëŠ” ê²Œì‹œê¸€ ëª©ë¡ í˜ì´ì§€ì™€ ê²Œì‹œê¸€ ìƒì„¸ í˜ì´ì§€ë¥¼ êµ¬í˜„ì„ í•´ë³´ê² ìŠµë‹ˆë‹¤. ë¸”ë¡œê·¸ë¥¼ ì‘ì„±í•œ ì½”ë“œëŠ” [ì—¬ê¸°](https://github.com/BaeYeongGi/blog-next)ì„œ í™•ì¸í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤ğŸ˜Š

---

## ê¸°ìˆ ìŠ¤íƒ

**1) í”„ë ˆì„ì›Œí¬:** [Next.js](https://nextjs.org/)

í˜„ì—…ì—ì„œë„ ì‹¤ì œ í”„ë¡œì íŠ¸ì— ì‚¬ìš©í•´ë³´ê¸° ìœ„í•´, ì‚¬ìš©ë²•ë„ ìµíê²¸ Next.js í”„ë ˆì„ ì›Œí¬ë¥¼ ì„ íƒí–ˆìŠµë‹ˆë‹¤. 

**2) ìŠ¤íƒ€ì¼:** [css module](https://nextjs.org/docs/app/building-your-application/styling/css) + [sass](https://sass-lang.com/)

ì²˜ìŒë¶€í„° ì§ì ‘ í•œë•€í•œë•€ ìŠ¤íƒ€ì¼ì„ ë‹¤ë£¨ëŠ”ë°ì— ìµìˆ™í•˜ê³  í˜„ì—…ì—ì„œ í™œìš©í•˜ëŠ”ê²Œ ìµìˆ™í•´ì„œ ì„ íƒí•œ css module + sass ì…ë‹ˆë‹¤. ì´ë¦„ ê·¸ëŒ€ë¡œ ëª¨ë“ˆ ë°©ì‹ìœ¼ë¡œ ì‘ì„±í•˜ì—¬ í´ë˜ìŠ¤ ì´ë¦„ì´ ê³ ìœ í•˜ê²Œ ì»´íŒŒì¼ ë˜ì–´ ë™ì¼í•œ í´ë˜ìŠ¤ëª… ì´ë”ë¼ë„ ì¶©ëŒì„ ë°©ì§€í•  ìˆ˜ ìˆëŠ” ì¥ì ì´ ë§ˆìŒì— ë“¤ì—ˆìŠµë‹ˆë‹¤. 

**3) ê¸€ì“°ê¸°:** [MDX](https://mdxjs.com/)  

README íŒŒì¼ì´ë‚˜ ì½”ë“œ ì„¤ëª…ë“±ì„ ì‘ì„±í•  ë•Œ í•„ìš”í•œ ë§ˆí¬ë‹¤ìš´ ë¬¸ë²•ì— ìµìˆ™í•´ì§€ê¸° ìœ„í•´ ì„ íƒí–ˆìŠµë‹ˆë‹¤. ë§ˆí¬ë‹¤ìš´ ë¬¸ë²•ìœ¼ë¡œ ìƒì„±ëœ ìš”ì†Œë¥¼ ì œê°€ ììœ ë¡­ê²Œ ì›í•˜ëŠ” ëª¨ì–‘ìœ¼ë¡œ ì»¤ìŠ¤í…€ í•  ìˆ˜ ìˆë‹¤ëŠ” ê²Œ ë§¤ë ¥ì ì´ì—ˆìŠµë‹ˆë‹¤!

**4) ê¸€íŒŒì‹±:** [gray-matter](https://github.com/jonschlinkert/gray-matter) + [next-mdx-remote](https://github.com/hashicorp/next-mdx-remote#react-server-components-rsc--nextjs-app-directory-support)

- gray-matter: ë§ˆí¬ë‹¤ìš´ íŒŒì¼ë¡œ ë¸”ë¡œê·¸ë¥¼ ìƒì„±í• ë•Œ mdx íŒŒì¼ ìƒë‹¨ì— ìˆëŠ”, í”„ë¡ íŠ¸ë§¤í„°(front matter, ë©”íƒ€ë°ì´í„° ë¸”ë¡) ì— ì ‘ê·¼í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤.
- next-mdx-remote: ì¶”í›„ì— mdx íŒŒì¼ ë‚´ì— ì§ì ‘ react ì»´í¬ë„ŒíŠ¸ë¥¼ ì„í¬íŠ¸í•˜ê³  ì‚¬ìš©í•˜ê¸°ìœ„í•´, ì»¤ìŠ¤í…€ êµ¬ì„±ì„ í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•©ë‹ˆë‹¤. 

**5) ë°°í¬:** [Vercel](https://vercel.com/)

ì‘ì—…í•œ ì½”ë“œë¥¼ ìë™ìœ¼ë¡œ ë¹Œë“œ & ë°°í¬í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤. ë³„ë„ì˜ ì„¤ì • ì—†ì´ GitHubê³¼ ì—°ë™í•˜ì—¬ ì½”ë“œë¥¼ í‘¸ì‹œí•˜ë©´ ìë™ìœ¼ë¡œ ë¹Œë“œ & ë°°í¬ê°€ ë˜ê³  ì• í”Œë¦¬ì¼€ì´ì…˜ ê°œë°œì—ë§Œ ì§‘ì¤‘í•  ìˆ˜ ìˆì–´ ì‚¬ìš©í•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.

---

## ê°œë°œí™˜ê²½

**1) Next.js**
> Node.js 18.18 ì´ìƒì˜ ë²„ì „ì´ í•„ìš”í•©ë‹ˆë‹¤! [(Installation ì°¸ê³ )](https://nextjs.org/docs/getting-started/installation)

```shell title="next install"
npx create-next-app@latest
```

```terminal {2, 4, 6} title="next install options"
What is your project named? my-app
Would you like to use TypeScript? Yes
Would you like to use ESLint? Yes
Would you like to use Tailwind CSS? No
Would you like to use `src/` directory? Yes
Would you like to use App Router? (recommended) Yes
Would you like to customize the default import alias (@/*)? Yes
What import alias would you like configured? @/*
```

css module + sass ë¥¼ ì‚¬ìš©í•˜ê¸°ë•Œë¬¸ì—, Tailwind ëŠ” ì„ íƒí•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.

**2) SCSS**

```shell title="install sass"
npm install sass -D
```

scss íŒŒì¼ë¡œ ì‚¬ìš©í•˜ê¸° ìœ„í•´ sassë¥¼ ì„¤ì¹˜í•©ë‹ˆë‹¤. css moduleê³¼ ì‚¬ìš©ë²•ë„ ë™ì¼í•˜ê³ , ë¶ˆëŸ¬ì˜¤ëŠ” íŒŒì¼ í™•ì¥ìëª…ë§Œ scssë¡œ ë³€ê²½í•˜ë©´ ì¤€ë¹„ê°€ ì™„ë£Œë©ë‹ˆë‹¤!

**3) ë””ë ‰í† ë¦¬ êµ¬ì¡°**

```css title="Directory"
ğŸ“¦public
 â”£ ğŸ“‚posts /* ê²Œì‹œê¸€ ë‚´ë¶€ì— ì‚¬ìš©í•  ì´ë¯¸ì§€ ì €ì¥ */
ğŸ“¦src
 â”£ ğŸ“‚app
 â”ƒ â”£ğŸ“‚blog
 â”ƒ â”ƒ â”—ğŸ“‚list
 â”ƒ â”ƒ â”—ğŸ“‚view/[slug]
 â”ƒ â”ƒğŸ“œfavicon.ico
 â”ƒ â”ƒğŸ“œlayout.tsx
 â”ƒ â”ƒğŸ“œpage.tsx
 â”£ ğŸ“‚components
 â”£ ğŸ“‚posts /* ê²Œì‹œê¸€ mdx íŒŒì¼ ì €ì¥ */ 
 â”£ ğŸ“‚lib
 â”— ğŸ“‚styles
```

---

## ê°œë°œ

**1) ê²Œì‹œê¸€ ì €ì¥**

ì‘ì„±í•œ ëª¨ë“  ê²Œì‹œê¸€ì€ `src/posts` ë””ë ‰í† ë¦¬ì— ì €ì¥í–ˆìŠµë‹ˆë‹¤.

ê°œë°œ ì§„í–‰ì„ ìœ„í•´ ê²Œì‹œê¸€ì„ í•˜ë‚˜ ìƒì„±í•˜ì˜€ìŠµë‹ˆë‹¤. `src/posts/blog.mdx`


```code title="blog.mdx"
---
title: "ê°œì¸ ë¸”ë¡œê·¸ ë§Œë“¤ê¸° Next.js 14"
date: "2024-08-27"
summary: "Next.js ì™€ MDX ë§ˆí¬ë‹¤ìš´ íŒŒì¼ë¡œ ê°œì¸ ë¸”ë¡œê·¸ë¥¼ ì˜ˆì˜ê²Œ ë§Œë“¤ì–´ ë´…ì‹œë‹¤ğŸ˜Š"
thumbnail: "/images/posts/blog/thumbnail.png"
---
![](/images/posts/blog/thumbnail.png)
```

**2) ê²Œì‹œê¸€ íŒŒì‹±**

ê²Œì‹œê¸€ íŒŒì‹±ì„ ìœ„í•´ [gray-matter](https://github.com/jonschlinkert/gray-matter)ë¥¼ ì„¤ì¹˜í•©ë‹ˆë‹¤.

```shell title="install gray-matter & fs"
npm install gray-matter fs
```

fs íŒ¨í‚¤ì§€ë¥¼ í†µí•´ íŒŒì¼ì„ ì½ëŠ” ì½”ë“œë„ í•¨ê»˜ ì‘ì„±í•´ì£¼ê³ , `matter` í•¨ìˆ˜ì— ì¸ìë¡œ ì „ë‹¬í•˜ë©´, `data` ì™€ `content` ê°’ì„ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê²Œì‹œê¸€ íŒŒì¼ì„ íŒŒì‹±í•˜ëŠ” í•¨ìˆ˜ëŠ” ì•„ë˜ì²˜ëŸ¼ ì‘ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```tsx title="src/app/blog/view/[slug]/page.tsx"
import { promises as fsPromises } from 'fs';
import path from 'path';
import matter from 'gray-matter';

// MDX íŒŒì¼ ê²½ë¡œ
const POSTS_DIR = path.join(process.cwd(), 'src', 'posts');

export default async function View({ params }: {params: {slug: string} }){
  const { slug } = params;
  const filePath = path.join(POSTS_DIR, `${slug}.mdx`);
  const fileContents = await fsPromises.readFile(filePath, "utf8");
  const { data, content } = matter(fileContents);
}

```

`data`ëŠ” ì•„ë˜ì™€ ê°™ì´ mdx íŒŒì¼ì˜ front matter ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.

```code title="blog.mdx front-matter"  
{
  title: 'ê°œì¸ ë¸”ë¡œê·¸ ë§Œë“¤ê¸° Next.js 14',
  date: '2024-08-27',
  summary: 'Next.js ì™€ MDX ë§ˆí¬ë‹¤ìš´ íŒŒì¼ë¡œ ê°œì¸ ë¸”ë¡œê·¸ë¥¼ ì˜ˆì˜ê²Œ ë§Œë“¤ì–´ ë´…ì‹œë‹¤ğŸ˜Š',
  thumbnail: '/images/posts/blog/thumbnail.png'
}
```

`content`ëŠ” ì•„ë˜ì™€ ê°™ì´ mdx íŒŒì¼ì˜ front-matterë¥¼ ì œì™¸í•œ í•˜ë‹¨ì˜ ë‚´ìš©ì„ ê°€ì ¸ì˜µë‹ˆë‹¤.

```code title="blog.mdx content"
![](/images/posts/blog/thumbnail.png)
```

ìœ„ì™€ ê°™ì´ íŒŒì‹± ì •ë³´ ê°ì²´ í•˜ë‚˜ë¥¼ ê°€ê³µí•˜ë©´ ê¸€ ìƒì„¸ í˜ì´ì§€ë¥¼ ë³´ì—¬ì¤„ ìˆ˜ ìˆê³ , ê²Œì‹œê¸€ íŒŒì¼ì„ ì—¬ëŸ¬ê°œ ìƒì„± í›„, íŒŒì‹± ì •ë³´ ë¦¬ìŠ¤íŠ¸ë¥¼ ë³´ì—¬ì£¼ë©´ ê¸€ ëª©ë¡ í˜ì´ì§€ë¥¼ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤!

**3) ê²Œì‹œê¸€ ëª©ë¡ í˜ì´ì§€**

`src/posts` ì— ì €ì¥ëœ `.mdx` íŒŒì¼ì„ ì „ë¶€ íƒìƒ‰í•©ë‹ˆë‹¤. ê° íŒŒì¼ëª…ì„ ê¸°ë°˜ìœ¼ë¡œ ì œëª©ì„ ë…¸ì¶œí•´ì„œ ëª©ë¡ì„ ê°€ì ¸ì˜µë‹ˆë‹¤.

ì €ì¥í•œ ëª¨ë“  íŒŒì¼ì˜ ê²Œì‹œê¸€ ëª©ë¡ì„ ì¡°íšŒí•˜ëŠ” í•¨ìˆ˜ëŠ” ì•„ë˜ì™€ ê°™ì´ ì‘ì„±í•©ë‹ˆë‹¤. ëª¨ë“  mdx íŒŒì¼ì˜ ê²½ë¡œë¥¼ ë¶ˆëŸ¬ì˜¤ê³ , ê° íŒŒì¼ë“¤ì˜ ì œëª©ê³¼ front matter ì •ë³´ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.


```ts title="src/lib/post.ts"
import path from 'path';
import fs from 'fs';
import matter from 'gray-matter';

// ëª¨ë“  mdx íŒŒì¼ ì¡°íšŒ
export function getPostList() {
  const filenames = fs.readdirSync(POSTS_DIR);
  return filenames.filter(filename => filename.endsWith('.mdx')).map((filename) => {
    const slug = filename.replace(/\.mdx$/, "");
    const filePath = path.join(POSTS_DIR, `${slug}.mdx`);
    const fileContents = fs.readFileSync(filePath, 'utf8');
    const { data } = matter(fileContents);
    return {
      slug, // .mdx íŒŒì¼ì˜ íŒŒì¼ëª…
      data  // .mdx íŒŒì¼ì˜ front matter 
    }
  })
};
```

`post.ts` ì‘ì„±í•œ í•¨ìˆ˜ë¥¼ í†µí•´ listë¥¼ render í•´ì£¼ë©´ ì™„ì„±ë©ë‹ˆë‹¤!

```tsx  {2, 8} title="src/app/blog/list/page.tsx"
import Link from 'next/link';
import { getPostList } from '@/src/lib/post';
import styles from '@/src/styles/List.module.scss';
import Image from 'next/image';
import { Calendar } from '@/public/images/svg/Calendar';

export default async function List(){
  const generateList = await getPostList();
  // ìµœì‹  ë‚ ì§œ ìˆœìœ¼ë¡œ í¬ìŠ¤íŠ¸ ì •ë ¬
  const setDateGenerateList = generateList.sort((a, b) => +new Date(b.data.date) - +new Date(a.data.date));

  return (
    <div>
      <ul className={styles.list_wrap}>
      {
        setDateGenerateList.map((item) => {
          return (
            <li key={item.slug} >
              <Link href={`/blog/view/${item.slug}`} key={item.slug}>
                <div className={styles.img_wrap}>
                  <Image src={item.data.thumbnail} alt=""  fill={true}/>
                </div>
                <div className={styles.date}><Calendar/> {item.data.date}</div>
                <h2 className={styles.title}>{item.data.title}</h2>
              </Link>
            </li>  
          )
        })
      }
        </ul>
    </div>
  )
}
```
ì•„ë˜ëŠ” ì™„ì„±ëœ post list í˜ì´ì§€ ì…ë‹ˆë‹¤.

![](/images/posts/blog/list.png)


**4) ìƒì„¸ í˜ì´ì§€**

ê²Œì‹œê¸€ íŒŒì¼ì„ íŒŒì‹±í•˜ì—¬ ë°ì´í„°ë¥¼ í™”ë©´ì— ë³´ì—¬ì£¼ë©´ ë©ë‹ˆë‹¤.

```tsx title="src/lib/post.ts" 
export async function getPostDetail(slug:string){
  const filePath = path.join(POSTS_DIR, `${slug}.mdx`);
  const fileContents = await fsPromises.readFile(filePath, "utf8");
  const { data, content } = matter(fileContents);
  const haedingList = getHeadingId(content);
  return {
    data,
    content,
    haedingList
  }
}
```

ë§ˆì°¬ê°€ì§€ë¡œ `post.ts` ì—ì„œ ì‘ì„±í•œ ìƒì„¸ í˜ì´ì§€ í•¨ìˆ˜ë¥¼ í†µí•´ render í•´ì£¼ë©´ ë©ë‹ˆë‹¤.

ì—¬ê¸°ì„  mdx ë³¸ë¬¸ì„ íŒŒì‹±í•˜ê¸°ìœ„í•´ [next-mdx-remote](https://github.com/hashicorp/next-mdx-remote#react-server-components-rsc--nextjs-app-directory-support)ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.


```shell title="install next-mdx-remote"
npm install next-mdx-remote
```

íŒŒì‹±í–ˆë˜, `content`ë¥¼ propsë¡œ MDXRemoteì— ì „ë‹¬í•˜ë©´ HTML ìš”ì†Œë¡œ ë³€í™˜í•˜ê²Œ ë©ë‹ˆë‹¤. 

```tsx title="MDXRemote"
export default async function View({ params }: {params: {slug: string} }){
  const { slug } = params;
  const { content } = await getPostDetail(slug);

  return (
    <MDXRemote
      source={content}
    />
  )
}
```

ì¶”ê°€ì ìœ¼ë¡œ íŒŒì‹±ëœ mdx ìš”ì†Œë¥¼ ê¾¸ë©°ì£¼ê¸° ìœ„í•´ plugin, custom componentë„ ì „ë‹¬í•´ì¤ë‹ˆë‹¤.

```tsx { 1,2,3,4,24,31,35 } title="src/app/blog/view/[slug]/page.tsx"
import { MDXRemote, MDXRemoteSerializeResult } from "next-mdx-remote/rsc";
import rehypePrettyCode from 'rehype-pretty-code';
import ExternalLink from '@/src/components/mdx/Link';
import rehypeSlug from 'rehype-slug';
import { getPostDetail } from '@/src/lib/post';
import TitleNavigation from '@/src/components/mdx/TitleNavigation';

const MdxComponents = {
  a: ExternalLink as any
}

export default async function View({ params }: {params: {slug: string} }){
  const { slug } = params;
  const { data, content, haedingList } = await getPostDetail(slug);
  return (
    <>
      <MDXRemote
        source={content}
        options={{
          mdxOptions: {
            rehypePlugins: [
              [
                // code ë¸”ëŸ­ì„ ê¾¸ë©°ì¤Œ
                rehypePrettyCode,
                {
                  theme: 'slack-dark',
                  keepBackground: true,
                }
              ],
              // Heading íƒœê·¸ì— ID ë¶€ì—¬
              rehypeSlug,
            ]
          }
        }}
        components={MdxComponents}
      />
    </>
  )
}
```

- bucket name
- AWS region
- filename

> blockquote

```ts {5-6}
import fs from 'fs';
import matter from 'gray-matter';

 `/src/posts/view/blog.mdx`


// ì£¼ì„ì²˜ë¦¬
const parsePost = async (postPath: string) => {
  const file = fs.readFileSync(postPath, 'utf8');
  const { data, content } = matter(file);
};
```








```tsx title="layout.tsx"
export default function RootLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return (
    <html lang="ko">
      <body >
        <ThemeProvider>
          <Header/>
          <Section>
            {children}
            <TopButton />
          </Section>
          <Footer />
        </ThemeProvider>
      </body>
    </html>
  );
}
```


```json title="aaa.json"
{
  title: 'title',
  date: 2024-02-26T00:00:00.000Z,
  desc: 'blog',
  thumbnail: 'thumbnail.jpg'
}
```
